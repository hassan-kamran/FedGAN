```markdown
# FedGAN: Privacy-Preserving Federated Learning for Diabetic Retinopathy Image Generation

![Generated Retinal Images](imgs/image_at_epoch_0001.png)  
*Example synthetic retinal images generated by FedGAN.*

## Abstract
FedGAN is a federated learning framework designed to generate synthetic medical images while preserving patient privacy. It combines **Generative Adversarial Networks (GANs)** with **cross-silo federated learning** to enable collaborative training across healthcare institutions without sharing raw data. The framework is pretrained on abdominal CT scans and fine-tuned on diabetic retinopathy datasets, achieving a realism score of **0.89 ± 0.03** with 10 clients. This work addresses data scarcity and privacy challenges in medical AI, complying with HIPAA and GDPR standards.

## Key Features
- **Privacy-Preserving Federated Training**: Federated Averaging (FedAvg) for aggregating GAN updates across silos.
- **Pretraining & Transfer Learning**: DCGAN pretrained on abdominal CT scans (`pretraining.py`) and fine-tuned on retinal data.
- **Non-IID Data Handling**: Tools for simulating real-world data distributions (`create_non_iid_splits.py`).
- **Medical Image Preprocessing**: CLAHE, gamma correction, and pixel binning for enhanced image quality (`preprocessing.py`).

## Code Structure
```
.
├── pretraining.py            # DCGAN pretraining on abdominal CT scans
├── preprocessing.py          # Image preprocessing and TFRecord generation
├── model_dcgan.py            # Generator and discriminator architectures
├── dcgan_training.py         # Federated and unfederated training workflows
├── custom_layers.py          # Custom transposed/convolutional layers
├── create_non_iid_splits.py  # Non-IID data split generation for FL
└── data/                     # TFRecord datasets (example structure)
```

## Installation
1. **Clone the repository**:
   ```bash
   git clone https://github.com/yourusername/FedGAN.git
   cd FedGAN
   ```

2. **Install dependencies**:
   ```bash
   pip install tensorflow matplotlib pandas tqdm tf_clahe
   ```

## Usage

### 1. Preprocess Data
Convert raw images to TFRecord format with preprocessing:
```bash
python preprocessing.py \
  --input_folder path/to/raw_images \
  --output_folder data/processed.tfrecord \
  --resolution 128 \
  --bin_size 16 \
  --labels path/to/diabetes_labels.csv
```

### 2. Pretrain DCGAN
Train the generator and discriminator on abdominal CT scans:
```bash
python pretraining.py \
  --tfrecord_file_path data/rsna-abdominal-128-16.tfrecord \
  --epochs 50 \
  --batch_size 64
```

### 3. Federated Training
Run federated learning with non-IID splits:
```bash
python dcgan_training.py
```
- Configure client settings, epochs, and paths in `CONFIG` within `dcgan_training.py`.
- Generated images and models are saved to `generated_images/` and `models/federated/`.

### 4. Generate Synthetic Images
Use a trained generator to synthesize retinal images:
```python
from model_dcgan import build_generator

generator = build_generator(200)
generator.load_weights("models/federated/global_generator.keras")
noise = tf.random.normal([16, 200])
generated_images = generator(noise, training=False)
```

## Methodology
1. **Pretraining**: DCGAN learns features from abdominal CT scans.
2. **Federated Fine-Tuning**:  
   - Clients train locally on non-IID retinal data splits.
   - Model updates are aggregated via FedAvg.
3. **Evaluation**: Centralized discriminator assesses synthetic image realism.

## Datasets
- **RSNA Abdominal Trauma CT**: [Kaggle](https://www.kaggle.com/datasets/theoviel/rsna-abdominal-trauma-detection-png-pt1)  
- **Diabetic Retinopathy**: [Kaggle](https://www.kaggle.com/datasets/saipavansaketh/diabetic-retinopathy-unziped)

## License
MIT License. See `LICENSE` for details.
``` 

This README provides a comprehensive overview of the project, setup instructions, and ties the code to the thesis context. Adjust paths and hyperparameters as needed for your use case.
